"use strict";function _toConsumableArray(a){return _arrayWithoutHoles(a)||_iterableToArray(a)||_unsupportedIterableToArray(a)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(a,b){if(a){if("string"==typeof a)return _arrayLikeToArray(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(a):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?_arrayLikeToArray(a,b):void 0}}function _iterableToArray(a){if("undefined"!=typeof Symbol&&null!=a[Symbol.iterator]||null!=a["@@iterator"])return Array.from(a)}function _arrayWithoutHoles(a){if(Array.isArray(a))return _arrayLikeToArray(a)}function _arrayLikeToArray(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d}/**
 * @author      OA Wu <comdan66@gmail.com>
 * @copyright   Copyright (c) 2015 - 2021, Lalilo
 * @license     http://opensource.org/licenses/MIT  MIT License
 * @link        https://www.ioa.tw/
 */Vue.component("product-crud-index",{props:{products:{type:Array,default:[],required:!0}},data:function data(){return{index:0}},template:El.render("\n    div\n      div._segmented => n=2   :i=index\n        label._item => *text='\u5DF2\u5206\u985E'   @click=index=0   :n=products.filter(p => p.groupId).length\n        label._item => *text='\u672A\u5206\u985E'   @click=index=1   :n=products.filter(p => !p.groupId).length\n\n      div._tableview.__group\n        label._item_kv._pointer.__arrow.menu => *for=product in products.filter(product => index ? !product.groupId : product.groupId)   :key=product.id   @click=$emit('show', products, product)\n          span._key => *text=product.title   \n          span._val => *text=numFormat(product.count) + '\u7B46'\n  ")}),Vue.component("product-crud-show",{props:{products:{type:Array,default:[],required:!0},product:{type:Object,default:null,required:!0}},data:function data(){return{spends:null,loading:!1,timer:null,groups:[],model:{nextId:0,keyword:""}}},mounted:function mounted(){var a=this;this.more(),API.GET("group").auth().done(function(b){return a.groups=b}).send()},methods:{more:function more(){var a=this;this.product&&API.GET("product/"+this.product.id+"/spend",this.model).auth().done(function(b){var c,d=b.spends,e=b.nextId;a.loading=!1,a.model.nextId=e,null===a.spends?a.spends=d:(c=a.spends).push.apply(c,_toConsumableArray(d))}).send()}},watch:{"model.keyword":function modelKeyword(){var a=this;return this.timer=setTimeout(function(){return a.more(a.loading=!0,a.model.nextId=0,a.spends=null)},500,clearTimeout(this.timer))}},template:El.render("\n    div.product-crud-show => *if=product\n\n      div._tableview.__group\n        span._item_kv\n          span._key => *text='\u958B\u92B7\u540D\u7A31'\n          span._val => *text=product.title\n        span._item_kv\n          span._key => *text='\u82B1\u8CBB\u7D00\u9304'\n          span._val => *text=numFormat(product.count) + '\u7B46'\n        span._item_kv\n          span._key => *text='\u4E0A\u6B21\u958B\u92B7'\n          span._val => *text=date('Y-m-d H:i:s', new Date(product.updateAt * 1000))\n\n      div._tableview.__group => *if=groups.length   header=\u6240\u5C6C\u5206\u985E\n        label._item._pointer.__arrow => *if=product.group   *text=product.group.title   @click=$emit('choice', groups, product)\n        label._item._pointer.__arrow.item-empty => *else   *text='\u8ACB\u9078\u64C7\u5206\u985E\u2026'   @click=$emit('choice', groups, product)\n      \n      form._form._tableview.__group.search => header=\u5FEB\u901F\u641C\u5C0B\n        input._input => type=input   :placeholder='\u540D\u7A31\u95DC\u9375\u5B57\u641C\u5C0B\u2026'   *model.trim=model.keyword   :readonly=loading\n\n      div.load => *if=spends===null   *text='\u8B80\u53D6\u4E2D\uFF0C\u8ACB\u7A0D\u5019\u2026'\n\n      template => *else\n        div.empty => *if=!spends.length   *text='\u76EE\u524D\u6C92\u6709\u4EFB\u4F55\u7684\u8CC7\u6599\u3002'\n\n        div._tableview.__group => *else header=\u958B\u92B7\u7D00\u9304\n          label._item_subtitle => *for=spend in spends   :key=spend.id\n            div\n              span._title => *text=spend.title\n              span._subtitle => *text=date('Y-m-d H:i:s', new Date(spend.timeAt * 1000))\n            span._status => *text=numFormat(spend.money)\n        \n        label._tableview.__group => *if=model.nextId\n          label._item._center._pointer.more => *text='\u66F4\u591A\u8CC7\u6599\u2026'   @click=more\n  ")}),Vue.component("product-crud-group",{props:{groups:{type:Array,default:[],required:!0},product:{type:Object,default:null,required:!0},productItem:{type:Object,default:null,required:!0}},methods:{choice:function choice(a){API.PUT("product/"+this.product.id+"/group",{groupId:a.id}).auth().send(),this.$emit("choice",this.product.group=a,this.productItem.groupId=a.id)}},template:El.render("\n    div._tableview.__group\n      label._item._pointer.__radio => *for=group in groups   :key=group.id   *text=group.title   :class={ active: product.group && product.group.id == group.id }   @click=choice(group)\n  ")});