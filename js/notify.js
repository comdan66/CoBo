"use strict";function _toConsumableArray(a){return _arrayWithoutHoles(a)||_iterableToArray(a)||_unsupportedIterableToArray(a)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(a,b){if(a){if("string"==typeof a)return _arrayLikeToArray(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(a):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?_arrayLikeToArray(a,b):void 0}}function _iterableToArray(a){if("undefined"!=typeof Symbol&&null!=a[Symbol.iterator]||null!=a["@@iterator"])return Array.from(a)}function _arrayWithoutHoles(a){if(Array.isArray(a))return _arrayLikeToArray(a)}function _arrayLikeToArray(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d}/**
 * @author      OA Wu <comdan66@gmail.com>
 * @copyright   Copyright (c) 2015 - 2021, Lalilo
 * @license     http://opensource.org/licenses/MIT  MIT License
 * @link        https://www.ioa.tw/
 */var timeago=function(a){for(var b,e=(new Date().getTime()-1e3*a)/1e3,d=[{b:10,f:"\u73FE\u5728"},{b:6,f:"\u4E0D\u5230 1 \u5206\u9418"},{b:60,f:" \u5206\u9418\u524D"},{b:24,f:" \u5C0F\u6642\u524D"},{b:30,f:" \u5929\u524D"},{b:12,f:" \u500B\u6708\u524D"}],c=1,f=0;f<d.length;f++,c=b)if(b=d[f].b*c,e<b)return(1<f?parseInt(e/c,10):"")+d[f].f;return parseInt(e/c,10)+" \u5E74\u524D"};Load.init({data:{identifier:"notify",offset:0,notifies1:null,notifies2:[],friends:[]},mounted:function mounted(){this.reload()},computed:{},methods:{reload:function reload(){this.offset=0,this.notifies1=[],this.notifies2=[],this.friends=[],this.loadData()},loadData:function loadData(){var a=this;API.GET("notify",{offset:this.offset,limit:3}).auth().done(function(b){var c,d,e=b.offset,f=b.notifies,g=b.friends;a.offset=e,a.friends=g;var h=3-a.notifies1.length;0<h&&(c=a.notifies1).push.apply(c,_toConsumableArray(f.splice(0,h))),(d=a.notifies2).push.apply(d,_toConsumableArray(f))}).send()},readAll:function readAll(){var a=this;API.PUT("notify").auth().done(function(b){var c=b.num;return Toastr.success("\u5168\u90E8\u901A\u77E5\u5DF2\u6A19\u793A\u70BA\u5DF2\u8B80\u3002",a.badge("notify",c))}).send()},setFriend:function setFriend(a,b){var c=this;API.PUT("friend/"+a.id+"/review",{isEnable:b?"yes":"no"}).auth().done(function(){var d=c.friends.indexOf(a);-1==d||c.friends.splice(d,1),b&&Toastr.success("\u5DF2\u7D93\u540C\u610F"+a.user.name+"\u7684\u8FFD\u8E64\u56C9\uFF01")}).fail(function(a){return Toastr.failure(a)}).send()}},template:El.render("\n    layout => :page=this\n\n      span.title => :slot='nav'   *text='\u901A\u77E5\u7D00\u9304'\n\n      button.right => :slot='nav'   @click=readAll   *text='\u5168\u90E8\u5DF2\u8B80'\n\n      div.load => *if=notifies1===null   *text='\u8B80\u53D6\u4E2D\uFF0C\u8ACB\u7A0D\u5019\u2026'\n\n      template => *else\n        div.empty => *if=!(notifies1.length + friends.length)   *text='\u76EE\u524D\u6C92\u6709\u4EFB\u4F55\u7684\u8CC7\u6599\u3002'\n\n        template => *else\n          div._tableview => *if=notifies1.length   header=\u65B0\u901A\u77E5\n            label._item.item => *for=notify in notifies1   :key=notify.id   :class={ '_pointer __arrow': notify.action }\n              figure => :style={backgroundImage: 'url(' + (notify.url || '/img/default_s.png') + ')'}\n              div\n                div.desc => *html=notify.content\n                span.ago => *text=timeago(notify.createAt)\n\n          div._tableview => *if=friends.length   header=\u8FFD\u8E64\u8ACB\u6C42\n            label._item.item => *for=friend in friends   :key=friend.id\n              figure => :style={backgroundImage: 'url(' + (friend.user.avatar || '/img/default_s.png') + ')'}\n              div\n                div.desc => *html='<b>' + friend.user.name + '</b> \u60F3\u8981\u8FFD\u8E64\u4F60\u7684\u958B\u92B7\u82B1\u8CBB\uFF01'\n                div.btns\n                  label._point._center => *text='\u78BA\u8A8D'   @click=e => setFriend(friend, true)\n                  label._point._center => *text='\u5FFD\u7565'   @click=e => setFriend(friend, false)\n\n          div._tableview => *if=notifies2.length   header=\u5148\u524D\u7684\u901A\u77E5\n            label._item.item => *for=notify in notifies2   :key=notify.id   :class={ '_pointer __arrow': notify.action }\n              figure => :style={backgroundImage: 'url(' + (notify.url || '/img/default_s.png') + ')'}\n              div\n                div.desc => *html=notify.content\n                span.ago => *text=timeago(notify.createAt)\n\n          div._tableview.__group\n            label._item._pointer._center.__link => *text='\u8F09\u5165\u66F4\u591A\u2026'   @click=loadData   *if=offset !== null\n\n")});